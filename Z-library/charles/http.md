[https学习](https://www.jianshu.com/p/a677fecec927)

# http
http是一个网络应用层的协议，用来传输web内容


### 1）http / tcp
tcp、udp是传输层协议，http的实现需要依赖tcp。http分两种
- 长连接

  如果是“长连接”的方式，浏览器也会先发起一个 TCP 连接去抓取页面。但是抓取页面之后，该 TCP 连接并不会立即关闭，而是暂时先保持着（所谓的“Keep-Alive”）。然后浏览器分析 HTML 源码之后，发现有很多外部资源，就用刚才那个 TCP 连接去抓取此页面的外部资源。

- 短连接

  在“短连接”的模式下，浏览器会先发起一个 TCP 连接，拿到该网页的 HTML 源代码（拿到 HTML 之后，这个 TCP 连接就关闭了）。然后，浏览器开始分析这个网页的源码，知道这个页面包含很多外部资源（图片、CSS、JS）。然后针对【每一个】外部资源，再分别发起一个个 TCP 连接，把这些文件获取到本地（同样的，每抓取一个外部资源后，相应的 TCP 就断开）


### 2）ssl / tls
https在http的传输层之上，增加了的个安全层（SSL、TLS协议实现），可以视作同一个东西的不同阶段。


### http / https区别
- HTTPS协议需要到ca申请证书，一般免费证书较少，因而需要一定费用。
- HTTP是超文本传输协议，信息是明文传输，HTTPS则是具有安全性的SSL加密传输协议。
- HTTP和HTTPS使用的是完全不同的连接方式，用的端口也不一样，前者使用的端口是80，后者使用的端口是443。
- HTTPS的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比HTTP协议安全。


### 握手挥手
握手阶段的信息都是明文的

- 1）客户端发出请求

    - 客户端生成的随机数A，稍后用于生成"对话密钥"。
    - 支持的协议版本
    - 支持的加密方法
    - 支持的压缩方法

- 2）服务器响应：

    - 服务器生成的随机数B，稍后用于生成"对话密钥"。
    - 确认使用的协议版本
    - 确认使用的加密方法
    - 服务器证书

- 3）客户端回应：

    - 客户端生成的随机数C，稍后用于生成"对话密钥"。
    - 编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送。
    - 客户端握手结束通知，并附加所有内容的hash值防止被篡改

- 4）客户端回应：

    - 编码改变通知，随后双方都是用协定的加密方法和秘钥通知
    - 服务端握手结束通知，并附加所有内容的hash值防止被篡改

至此三次握手，四次挥手完成。接下来服务端与客户端之间的通信就是普通的http协议，只不过是用“会话秘钥”来加密内容。这个会话秘钥是三个随机数通过开始的加密方法生成的。
