性能优化

[视频链接 http://www.zhenchuanx.com/course/70/task/335/show](http://www.zhenchuanx.com/course/70/task/335/show)


# http缓存

浏览器会对请求的静态文件进行缓存，下面将介绍为什么被缓存，以及缓存是怎样生效的

## 简单介绍http报文

报文就是服务器与浏览器之间通信时，发送的数据块，报文分为两部分：
- 首部（cookie，缓存信息）
- 主题（想要传输的内容）

http缓存分为两种：
- 强制缓存
- 对比缓存



## 强制缓存
强制缓存有两个字段来表明失效规则，

- Expires（1.0产物，现在默认1.1）
    
    expires的值为服务端返回的到期时间，即下一次请求时，请求时间小于服务端返回的到期时间，直接使用缓存数据

- Cache-Control
    - max-age=xxx：缓存的内容将在 xxx 秒后失效
    - no-cache: 需要使用对比缓存
    - no-store: 强制不缓存


## 对比缓存
对比的是 **缓存标识** 与 **数据**

- Last-Modified（服务器 --> 客户端）

    服务器在响应请求时，告诉浏览器资源的最后修改时间

- If-Modified-Since（客户端 --> 服务器）

    再次请求时，通过此字段通知服务器上次请求时，服务器返回的资源最后修改时间（上一次的Last-Modified）

- Etag（服务器 --> 客户端）

    告诉浏览器当前资源在服务器的唯一标识

- If-None-Match（客户端 --> 服务器）

    再次请求服务器时，通过此字段通知服务器客户段缓存数据的唯一标识


# 总结

强制缓存，服务器通知浏览器一个缓存时间，在缓存时间内，下次请求，直接用缓存，不在时间内，执行比较缓存策略

比较缓存，将缓存信息中的Etag和Last-Modified通过请求发送给服务器，由服务器校验，返回304状态码时，浏览器直接使用缓存


---






